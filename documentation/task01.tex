\chapter{Úvod}

\chapter{Rozbor řešené problematiky}

Počítačový výkon je ůčinnost daného systému neboli jak dobře funguje, když se vezmou v úvahu všechny možné aspokty.
Hodnocení výkonu počítače je definováno jako proces při kterém se posuzují zdroje a výstupy počítače, aby se zjistilo,
jestli systém funguje na optimální úrovni.

Počítačové vyhodnocování je složitý proces. Při vyhodnoconváůní výkonu počítače se k určení využívá řada aspektů.
\paragraph{Hlavní aspekty}\cite{metricsToday}
\begin{itemize}
    \item{škálovatelnost}
    \item{stabilita}
    \item{schopnost reagovat}
    \item{rychlost}
    \item{dostupnost}
    \item{propustnost}
    \item{doba odezvy}
    \item{spolehlivost}
    \item{provozuschopnost}
\end{itemize}

Napsat to do vysvetlivek a vysvetlit i zbytek, popsat jeste nejake metriky nize
Propustnost. Propustnost je počet jednotek dat, které systém zpracuje za určitou dobu.
Doba odezvy. doba odezvy měří, kolik času trvá systému, než zareaguje na dotaz nebo poptávku.
Spolehlivost, dostupnost a provozuschopnost (RAS). RAS označuje schopnost softwaru trvale plnit své specifikace; jak dlouho funguje vzhledem k očekávanému množství; a jak snadno se dá opravit nebo udržovat.

Ke zjištění těchto aspektů se využívají speciálně navržené programy, které posuzují relativní výkon daného objektu obvykle spušténím řady testů.
Tento proces se nazývá benchmark. Není jednoduché vytvořit měřítka pro hodnocení výkonu počítaču, protože technologické vlastnosti se stále vývýjí a obměňují.
Toto znamené, že benchmark počítačů musí být také neustále vyvíjen a aktualizován.

https://study.com/academy/lesson/computer-performance-evaluation-definition-challenges-parameters.html

\section*{Metriky k měření}

Před každým měřením by mělo být jasně dáno jaké metriky budeme měřit a jakým způsobem se to bude vykonávat. Pokud metriky ani způsob nebude stanoven, tak je měření ztrátou času.
Ověření těchto metrik se poté provádí testováním. Svoji důležitou roli hraje také složitost tesovaného softwaru. Mezi základní metriky k měření výkonu systému jsou:

\subsection*{Doba spuštění a doba načítání}

Každý software vyžaduje nějaký čas k jeho načtení a zahájení provozu. Koncový uživatelé během této doby obvykle vidí animovaný kurzor nebo načítání obrazovky.
Složité programy mohou vyžadovat nastavení a konfiguraci než uživatele pustí do práce. Software například kontroluje závislost s jiným softwarem nebo existenci potřebných souborů.
Toto zvyšuje jeho dobu načítání. Doba načítání by proto měla být co nejkratší.

\subsection*{Doba odezvy nebo latence}

Doba odezvy označováná jako latence je doba prodlevy mezi okamžikem, kdy uživatel zadá vstup, a okamžikem, kdy daný software na základě tohoto vstupu reaguje.
V ideálním připadě by tato doba měla být pro uživatele neposřehnutelná. Tato doba také může záviset na hardaru nebo na rychlosti připojení.

\subsection*{Omezené zatížení nebo špatná škálovatelnost}

Aplikace by měly obsluhovat omezený počet zařízení nebo uživatelů bez snížení výkonu softwaru. Škálovatelnost pomáhá zajistit, aby aplikace měla prostředky pro podporu očekávaného počtu uživatelů.
Testování výkonu hodnotí software při různých podmínkách zátěže. Nedostatečné zdroje, jako je nedostatečný výpočetní výkon, mohou způsobit špatnou škálovatelnost.
Výkon softwaru je však prostředky plus návrh a mnoho problémů se škálovatelností vyplývá ze špatné architektury aplikací. Každá aplikace by měla být napsaná tak, aby se dala v budoucnu škálovat.

\subsection*{Bottlenecks neboli uzká místa} napsat co to znamena v čestine

Každá aplikace přistupuje k omezenému zdrojů, jako třeba výpočetní výkon, paměťový prostor, šířka pásma, propustnost sítě, kapacita diskového ůložiště a vstupy/výstupy
a služby operačního systému. Úzká místa jsou nedostatky zdrojů, ke kterým dochází pokud software není vhodně navržen nebo pokud systém pro danou aplikaci není dostačující.

https://searchsoftwarequality.techtarget.com/answer/Required-prerequisites-for-performance-testing

\section{Metody}

Vyhodnocování výkonu počítačů je důležitou technologii pro výzkum v oblasti počítačů. Neustálý vývoj počítačů dělá tento úkol stále složitější.
Obecný problém rozvoje efektivní vyhodnocovací techniky lze vyjádřit jako hledání nejlepšího kompromisu mezi přesností a rychlostí. Tento kompromis závisí na
použití vyhodnocovací metody. Správná efektivita může vést ke snížení nákladů při tvorbě systému pro běh aplikace.

\section{Testování}

Vzhledem k velkému potenciálu hrozeb v souvislosti s výkonem softwaru, mohou různé testy zaměřené na výkon vyhodnitit specifické chování softwaru. Mezi důležité typy testů patří:
\begin{itemize}
    \item{zátěžový}
    \item{odolnostní}
    \item{spike}
    \item{závislostní}
\end{itemize}

\subsection*{Zátěžové testy}

Tento typ testů obecně měří pohyb dat, také nazývaný jako propustnost. Zátěživý test pomáhá ověřit zda daný software funguje správně za typických podmínek. Cílem zátěžového testování je zajistit,
aby klíčové metriky výkonu, jako propustnost dat za sekundu nebo přístup disku za sekundu, zůstaly přijatelné, když se připojí více zařízení nebo více uživatelů. Pokud testování významně
ovlivňuje metriky výkonu, tak je to signál k úpravě softwaru. Případně zjištění maximálního limitu softwaru.

\subsection*{Odolnostní testy}

Odolnostní testy jsou charakteristické tím, že se provádí po delčí dobu. Jejich cílem je ověřit, jestli se výkonnostní charakteristiky softwaru v průběhu provádění nemění. Odolnostní testy
zachycují nedostatky jako je nedostatečná paměť. Při krátkém testování by se tento problém nemusel vůbec objevit.

\subsection*{Spike testy}

Spike testy simulují náhle změny uživatelské zátěže za účelem měření odezvy softwaru.

\subsection*{Závislostní testy}

Software zřídka funguje sám o sobě. Většinou spoléha na jiné aplikace nebo případně na databázi. Testy závislosti vyhodnocují výkon softwaru při zátěži, ale vztahují se na závislosti, nikoliv
jen na software.

https://searchsoftwarequality.techtarget.com/answer/Required-prerequisites-for-performance-testing

\iffalse
\subsection{Existující řešení}
\fi

\section{Přehled nástrojů}

\subsection{Berkeley Packet Filter}

Berkeley Packet Filter nebo také BPF je technologie, která umožňuje spouštět programy v jádře operačního systému na linuxových systémech.
Efektivně a bezpečně rozšíří schopnosti jádra bez nutnosti měnit zdrojový kód jádra. Tato schopnost je často použita ke sledování využití systému či sledování síťového provozu.
BPF je k dispozici na většině unixových operačních systémů a extended BPF je také k dispozici pro Microsoft Windows.

\subsection*{Sledování síťového provozu}
BPF poskytuje rozhranní k datové lince, což umožňuje odesílání a přijímání paketů spojové vrstvy. BPF podporuje filtrování paketů a umožňuje user space(vysvětlit proč jsem to napsal anglicky) procesům,
aby si samy vyfiltrovaly pakety, které chtějí obdržet a které naopak zahodit. Toto může vést ke zvýšení výkonu operačního systému, protože se tím zamezí kopírování nepotřebných paketů.

\subsection*{Verze BPF}
BPF má více verzí. Výše zmíňenou extended BPF (eBPF) nebo také classic BPF (cBPF).

\subsection*{extended BPF - eBPF}
Extended BPF povoluje spouštět programy v rámci operačního systému a přidávat další funkce za běhu.
Operační systém pak zaručuje bezpečnost a efektivitu provádění. Díky to tomu je na eBPF je založeno hned několik projektů.
eBPF se používá pro  poskytování vysoce výkonných sítí a vyvažování zátěže v moderních datových centrech a cloudových nativních prostředích,
získávání podrobných dat o pozorovatelnosti zabezpečení při nízké režii, pomáhá vývojářům aplikací sledovat aplikace,
poskytování přehledů pro řešení problémů s výkonem a mnoho dalšího.

\subsection*{classic BPF - cBPF}
Classic BPF je jenom přejmenovaná originální verze BPF.

https://man7.org/linux/man-pages/man2/bpf.2.html
https://ebpf.io/

\subsection{Rozdíl mezi user spacem a kernal spacem}
\subsection*{kernel space}
Kernel space je prostor kde je uložen kód kernelu a kde je vykonáván.

\subsection*{user space}
User space je sada míst, kde běží uživatelské procesy(všechno ostatní kromě jádra). Jádro řídí aplikace v tomto prostoru tak, aby se nepletly mezi sebou.
Procesy, které běží v user spacu mají omezenou část paměti a také nemají přístup ke kernel spacu. Procesy běžící v user spacu mohou přistupovat do kernel spacu
jedině přes rozhranní vystavenný kernel spacem - systémová volání. Pokud proces provede systémové volání, tak se do jádra odešle systémové přerušení a jádro poté obslouží
příslušný proces. Jádro pokračuje ve své práci až po dokončení přerušení.

\subsection{Netem}\cite{netem}
Netem je softwarová utilita pomocí které lze vykonávat síťovou emulaci. Síťovou emulaci lze využít k omezení internetových zdrojů pro měřenou aplikaci pro lepší testování.
Netem umí simulovat zpomalení, ztrátu, poškození nebo duplikaci paketů a případně změnu pořadí paketů. Netem je řízen pomocí nástroje 'tc', který se ovládá pomocí příkazové řádky.
Jeho aktuální distribuce je multiplatformě podporována.

\subsection*{Zpoždění paketů}
Tento příkaz přidá zpoždění všech paketů o 100 milisekund. Toto nastavení je ještě omezeno rozlišením jádra.
\begin{lstlisting}[language=bash]
    $ tc qdisc add dev <interface> root netem delay 100ms
\end{lstlisting}

Lze i nastavit zpoždění pomocí rozdělení. Příklad s normalním rozdělením:
\begin{lstlisting}[language=bash]
    $ tc qdisc change dev <interface> root netem delay 100ms 20ms distribution normal
\end{lstlisting}

\subsection*{Ztráta paketů}
Tento příkaz zajistí ztrátu paketů. 1 paket z 1000 je zahozen. nejnižší možná nastavitelná hodnota je 0.0000000232%.
\begin{lstlisting}[language=bash]
    $ tc qdisc change dev <interface> root netem loss 0.1%
\end{lstlisting}

\subsection*{Duplikace paketů}
Příkaz pro duplikaci paketů je podobný jako příkaz pro ztrátu paketů.
\begin{lstlisting}[language=bash]
    $ tc qdisc change dev <interface> root netem duplicate 1%
\end{lstlisting}

\subsection*{Poškození paketů}
Tímto příkazem lze nastavit poškození paketů. Ten zavede bitovou chybu v náhodném offsetu v paketu.
\begin{lstlisting}[language=bash]
    $ tc qdisc change dev <interface> root netem corrupt 0.1%
\end{lstlisting}

\subsection*{Přeuspořádání paketů}
Existují dva způsoby jak nastavit přeuřpořádání paketů.
První způsob je pomocí metody gap, která používá přednastavenou sequekci a změní pořadí každého Ntýho paketu.
\begin{lstlisting}[language=bash]
    $ tc qdisc change dev <interface> root netem gap 5 delay 10ms
\end{lstlisting}
Druhá metoda je reorder způsobí, že určité procento paketů se špatně seřadí.
\begin{lstlisting}[language=bash]
    $ tc qdisc change dev <interface> root netem delay 10ms reorder 25% 50%
\end{lstlisting}

\subsection*{Obnovení rozhranní}
Tento příkaz smaže všechno nastavení na rozhranní. Rozhranní bude poté fungovat jako by na něm žádné nastavení nebylo.
\begin{lstlisting}[language=bash]
    sudo tc qdisc del dev <interface> root
\end{lstlisting}

\subsection{Virtuální počítač s omezenými zdroji}

Pro zajištění více testovacích platforem je jedna z
Bohužel výpočetní hardware bude stejný pro všechny virtuální platformy i když bude omezený.

\iffalse
\subsection*{Raspberry pi}
\fi